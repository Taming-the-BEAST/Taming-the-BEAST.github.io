<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="utf-8"/>
	<title>Model selection</title>
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	
	<!-- RSS feed -->
	<link rel="alternate" type="application/rss+xml" title="Taming the BEAST" href="https://taming-the-beast.org//feed.news.xml">
	<link rel="alternate" type="application/rss+xml" title="Taming the BEAST" href="https://taming-the-beast.org//feed.tutorials.xml">

	
    <!-- Favicon -->
    <link rel="shortcut icon" href="/images/favicon.ico">	

    <!-- Our style -->
    <link rel="stylesheet" type="text/css" href="/css/style.css">

    <!-- JQuery and Bootstrap JS (necessary for collapsing navbar) -->
    <script src="/js/jquery-3.6.0.min.js"></script>
    <script src="/bootstrap/js/bootstrap.bundle.min.js"></script>

    <!-- Bootstrap Icons -->
    <link rel="stylesheet" type="text/css" href="/bootstrap/icons/bootstrap-icons.css">

    <!-- KaTeX -->
    <link rel="stylesheet" href="/css/katex.css">
    <script src="/js/katex.min.js"></script>

</head>


<body>
	
	<div id="header">

  <nav class="navbar navbar-expand-lg navbar-light bg-light">
    
    <a class="navbar-brand" href="/">
      <img src="/images/logo_bw.svg" style="height:2em">Taming the BEAST
    </a>
    
  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>
  <div class="collapse navbar-collapse" id="navbarNav">
    <ul class="navbar-nav">
      <li class="nav-item active">
        <a class="nav-link " aria-current="page" href="/news/">news</a>
      </li>
      <li class="nav-item">
        <a class="nav-link " href="/workshops/">workshops</a>
      </li>
      <li class="nav-item">
        <a class="nav-link " href="/tutorials/">tutorials</a>
      </li>
      <li class="nav-item">
        <a class="nav-link " href="/contribute/">contribute</a>
      </li>
      <li class="nav-item">
        <a class="nav-link" type="application/rss+xml" href="/feed.news.xml">
          <i class="bi bi-rss"></i>
        </a>
      </li>
    </ul>
  </div>
</nav>

</div>

	
	<div class="container">	
		
	

<div class="row">
	<div class="hidden-xs hidden-sm col-md-12">
		<div class="bigtitle titlebox">
			<ol class="breadcrumb">
			
			
				
				
				
				<li><a class="off" href="/tutorials/NS-tutorial/">Model selection</a></li>
				
			
			</ol>
		</div>
		<p>
		<div class="head">
			
				Model selection with nested sampling
			
		</div>
		
		<div class="smallhead">
			by
			
			
				
						Remco Bouckaert
					
						
					
			
		</div>
		
	</div>				
</div>

<div class="bigspacer"></div>

<div class="row">
	<div class="col-md-3">
	<div id="sidebar">
		<div class="bigspacer"></div>
		<div class="smallhead">
			Tutorial
		</div>		
		<div class="pad-left smallnote">
			<ul class="list-unstyled">
			
			<div class="smallspacer"></div>
			<li>
				<i class="bi bi-github"></i>
				<a class="off" href="https://github.com/sgtRoberty/NS-tutorial" target="_blank">Github repository</a>
			</li>
			<div class="smallspacer"></div>
			<li>
				<i class="bi bi-star"></i>
				<a class="off" href="LICENSE.html">
				License</a>
			</li>
			<div class="smallspacer"></div>
			<li>			
				<i class="bi bi-bar-chart"></i>
				<a class="off" href="https://github.com/sgtRoberty/NS-tutorial/graphs/traffic" target="_blank">
				Statistics</a>
			</li>
			</ul>
		</div>		
		<div class="spacer"></div>
		 	
		<div class="smallhead">
			Data
		</div>		
		<div class="pad-left smallnote">
			<ul class="list-unstyled">
			
				
				<div class="smallspacer"></div>
				<li> 
					<i class="bi bi-justify"></i>
					<!--a class="off" href="https://github.com/sgtRoberty/NS-tutorial/raw/main/data/HBV.nex" target="_blank" rel="nofollow"-->
					<a class="off" href="https://raw.githubusercontent.com/sgtRoberty/NS-tutorial/main/data/HBV.nex" target="_blank" rel="nofollow">
						HBV.nex
					</a>
				</li>
			
			</ul>
		</div>		
		<div class="spacer"></div>
		
		 	
		<div class="smallhead">
			XML
		</div>		
		<div class="pad-left smallnote">
			<ul class="list-unstyled">
			
				
				<div class="smallspacer"></div>
				<li> 
					<i class="bi bi-code-slash"></i>
					<!--a class="off" href="https://github.com/sgtRoberty/NS-tutorial/raw/main/xml/HBVStrict-NS.xml" target="_blank" download rel="nofollow"-->
					<a class="off" href="https://raw.githubusercontent.com/sgtRoberty/NS-tutorial/main/xml/HBVStrict-NS.xml" target="_blank" rel="nofollow">
						HBVStrict-NS.xml
					</a>
				</li>
			
				
				<div class="smallspacer"></div>
				<li> 
					<i class="bi bi-code-slash"></i>
					<!--a class="off" href="https://github.com/sgtRoberty/NS-tutorial/raw/main/xml/HBVStrict-NS30.xml" target="_blank" download rel="nofollow"-->
					<a class="off" href="https://raw.githubusercontent.com/sgtRoberty/NS-tutorial/main/xml/HBVStrict-NS30.xml" target="_blank" rel="nofollow">
						HBVStrict-NS30.xml
					</a>
				</li>
			
				
				<div class="smallspacer"></div>
				<li> 
					<i class="bi bi-code-slash"></i>
					<!--a class="off" href="https://github.com/sgtRoberty/NS-tutorial/raw/main/xml/HBVStrict.xml" target="_blank" download rel="nofollow"-->
					<a class="off" href="https://raw.githubusercontent.com/sgtRoberty/NS-tutorial/main/xml/HBVStrict.xml" target="_blank" rel="nofollow">
						HBVStrict.xml
					</a>
				</li>
			
				
				<div class="smallspacer"></div>
				<li> 
					<i class="bi bi-code-slash"></i>
					<!--a class="off" href="https://github.com/sgtRoberty/NS-tutorial/raw/main/xml/HBVUCLN-NS.xml" target="_blank" download rel="nofollow"-->
					<a class="off" href="https://raw.githubusercontent.com/sgtRoberty/NS-tutorial/main/xml/HBVUCLN-NS.xml" target="_blank" rel="nofollow">
						HBVUCLN-NS.xml
					</a>
				</li>
			
				
				<div class="smallspacer"></div>
				<li> 
					<i class="bi bi-code-slash"></i>
					<!--a class="off" href="https://github.com/sgtRoberty/NS-tutorial/raw/main/xml/HBVUCLN-NS30.xml" target="_blank" download rel="nofollow"-->
					<a class="off" href="https://raw.githubusercontent.com/sgtRoberty/NS-tutorial/main/xml/HBVUCLN-NS30.xml" target="_blank" rel="nofollow">
						HBVUCLN-NS30.xml
					</a>
				</li>
			
				
				<div class="smallspacer"></div>
				<li> 
					<i class="bi bi-code-slash"></i>
					<!--a class="off" href="https://github.com/sgtRoberty/NS-tutorial/raw/main/xml/HBVUCLN.xml" target="_blank" download rel="nofollow"-->
					<a class="off" href="https://raw.githubusercontent.com/sgtRoberty/NS-tutorial/main/xml/HBVUCLN.xml" target="_blank" rel="nofollow">
						HBVUCLN.xml
					</a>
				</li>
			
			</ul>
		</div>	
		<div class="spacer"></div>
		
		
		 
		<div class="smallhead">
			Output
		</div>		
		<div class="pad-left smallnote">
			<ul class="list-unstyled">
			
				
				<div class="smallspacer"></div>
				<li> 
					<i class="bi bi-file-text"></i>
					<!--a class="off" href="https://github.com/sgtRoberty/NS-tutorial/raw/main/precooked_runs/HBVStrict-NS30.log" target="_blank" download rel="nofollow"-->
					<a class="off" href="https://raw.githubusercontent.com/sgtRoberty/NS-tutorial/main/precooked_runs/HBVStrict-NS30.log" target="_blank" rel="nofollow">
						HBVStrict-NS30.log
					</a>
				</li>
			
				
				<div class="smallspacer"></div>
				<li> 
					<i class="bi bi-file-text"></i>
					<!--a class="off" href="https://github.com/sgtRoberty/NS-tutorial/raw/main/precooked_runs/HBVStrict-NS30.out" target="_blank" download rel="nofollow"-->
					<a class="off" href="https://raw.githubusercontent.com/sgtRoberty/NS-tutorial/main/precooked_runs/HBVStrict-NS30.out" target="_blank" rel="nofollow">
						HBVStrict-NS30.out
					</a>
				</li>
			
				
				<div class="smallspacer"></div>
				<li> 
					<i class="bi bi-file-text"></i>
					<!--a class="off" href="https://github.com/sgtRoberty/NS-tutorial/raw/main/precooked_runs/HBVStrict.log" target="_blank" download rel="nofollow"-->
					<a class="off" href="https://raw.githubusercontent.com/sgtRoberty/NS-tutorial/main/precooked_runs/HBVStrict.log" target="_blank" rel="nofollow">
						HBVStrict.log
					</a>
				</li>
			
				
				<div class="smallspacer"></div>
				<li> 
					<i class="bi bi-file-text"></i>
					<!--a class="off" href="https://github.com/sgtRoberty/NS-tutorial/raw/main/precooked_runs/HBVUCLN-NS30.log" target="_blank" download rel="nofollow"-->
					<a class="off" href="https://raw.githubusercontent.com/sgtRoberty/NS-tutorial/main/precooked_runs/HBVUCLN-NS30.log" target="_blank" rel="nofollow">
						HBVUCLN-NS30.log
					</a>
				</li>
			
				
				<div class="smallspacer"></div>
				<li> 
					<i class="bi bi-file-text"></i>
					<!--a class="off" href="https://github.com/sgtRoberty/NS-tutorial/raw/main/precooked_runs/HBVUCLN-NS30.out" target="_blank" download rel="nofollow"-->
					<a class="off" href="https://raw.githubusercontent.com/sgtRoberty/NS-tutorial/main/precooked_runs/HBVUCLN-NS30.out" target="_blank" rel="nofollow">
						HBVUCLN-NS30.out
					</a>
				</li>
			
				
				<div class="smallspacer"></div>
				<li> 
					<i class="bi bi-file-text"></i>
					<!--a class="off" href="https://github.com/sgtRoberty/NS-tutorial/raw/main/precooked_runs/HBVUCLN.log" target="_blank" download rel="nofollow"-->
					<a class="off" href="https://raw.githubusercontent.com/sgtRoberty/NS-tutorial/main/precooked_runs/HBVUCLN.log" target="_blank" rel="nofollow">
						HBVUCLN.log
					</a>
				</li>
			
			</ul>
		</div>		
		
		<div class="spacer"></div>
		<div class="smallhead">
			Contributors
		</div>	
		<div class="pad-left note">
				
			<div class="smallspacer"></div>				
			<div>
				<a class="off" href="https://github.com/rbouckaert">
    			<img class="pull-left avatar" src="https://avatars.githubusercontent.com/u/3612959?v=4&s=50">
    			<div class="handlebox" style="padding-left:5px;">
    				rbouckaert
    			</div>
 				</a>
 			</div>			
 				
			<div class="smallspacer"></div>				
			<div>
				<a class="off" href="https://github.com/laduplessis">
    			<img class="pull-left avatar" src="https://avatars.githubusercontent.com/u/8872277?v=4&s=50">
    			<div class="handlebox" style="padding-left:5px;">
    				laduplessis
    			</div>
 				</a>
 			</div>			
 				
			<div class="smallspacer"></div>				
			<div>
				<a class="off" href="https://github.com/sgtRoberty">
    			<img class="pull-left avatar" src="https://avatars.githubusercontent.com/u/101582763?v=4&s=50">
    			<div class="handlebox" style="padding-left:5px;">
    				sgtRoberty
    			</div>
 				</a>
 			</div>			
 				
			<div class="smallspacer"></div>				
			<div>
				<a class="off" href="https://github.com/jugne">
    			<img class="pull-left avatar" src="https://avatars.githubusercontent.com/u/26361891?v=4&s=50">
    			<div class="handlebox" style="padding-left:5px;">
    				jugne
    			</div>
 				</a>
 			</div>			
 			
		</div>
		<div class="bigspacer"></div>
		<div class="smallhead">
			Latest commits
		</div>		
		<div class="pad-left smallnote">
			<ul class="list-unstyled">
			
				<div class="smallspacer"></div>
				<li> 
					<i class="bi bi-check-square"></i>
					<a class="off" href="https://github.com/sgtRoberty/NS-tutorial/commit/a481162683bf0af2d39798d13780bee2808849b4">
					10 Jul 2025 - <span class="text-gray">Fixed some typos</span>
					</a> 
				</li>
			
				<div class="smallspacer"></div>
				<li> 
					<i class="bi bi-check-square"></i>
					<a class="off" href="https://github.com/sgtRoberty/NS-tutorial/commit/751f6e3d92200d330fadc212e90a135b6cd1f9d1">
					09 Jul 2025 - <span class="text-gray">Wrong character</span>
					</a> 
				</li>
			
				<div class="smallspacer"></div>
				<li> 
					<i class="bi bi-check-square"></i>
					<a class="off" href="https://github.com/sgtRoberty/NS-tutorial/commit/8cb3cd2b69d054d16594d3becacf403dfecee507">
					09 Jul 2025 - <span class="text-gray">Math formatting</span>
					</a> 
				</li>
			
				<div class="smallspacer"></div>
				<li> 
					<i class="bi bi-check-square"></i>
					<a class="off" href="https://github.com/sgtRoberty/NS-tutorial/commit/320431239694a6b16e6326db9f6a1c2a60f1c3ca">
					09 Jul 2025 - <span class="text-gray">Start to fix math</span>
					</a> 
				</li>
			
				<div class="smallspacer"></div>
				<li> 
					<i class="bi bi-check-square"></i>
					<a class="off" href="https://github.com/sgtRoberty/NS-tutorial/commit/0be76e72861405f188b1c1165133d3a34f3a675a">
					09 Jul 2025 - <span class="text-gray">Start to fix math</span>
					</a> 
				</li>
			
			</ul>
		</div>		
		<div class="spacer"></div>	
	</div>
	</div>

	<div class="col-md-8">				
		<div class="post">
			<p>
			<h1 id="background">Background</h1>

<p>BEAST provides a bewildering number of models. Bayesians have two techniques to deal with this problem: model averaging and model selection. With <strong>model averaging</strong>, the MCMC algorithm jumps between different models, and models more appropriate for the data will be sampled more often than unsuitable models (see for example the <a href="https://taming-the-beast.org/tutorials/Substitution-model-averaging/">substitution model averaging tutorial</a>). <strong>Model selection</strong> on the other hand just picks one model and uses only that model during the MCMC run. This tutorial gives some guidelines on how to select the model that is most appropriate for your analysis.</p>

<p>Bayesian model selection is based on estimating the marginal likelihood: the term forming the denominator in Bayes’ formula. This is generally a computationally intensive task and  there are several ways to estimate them. Here, we concentrate on nested sampling as a way to estimate the marginal likelihood as well as the uncertainty in that estimate.</p>

<p>Say, we have two models,  <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>M</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">M_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.109em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> and  <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>M</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">M_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.109em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>, and estimates of their (log) marginal likelihoods,  <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Z</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">Z_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">Z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> and <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Z</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">Z_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">Z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>. We can calculate the Bayes’ factor (BF), which is the fraction <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi><mi>F</mi><mo>=</mo><msub><mi>Z</mi><mn>1</mn></msub><mi mathvariant="normal">/</mi><msub><mi>Z</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">BF = Z_1/Z_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">BF</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">Z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">/</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">Z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> (or the difference <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>log</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>B</mi><mi>F</mi><mo stretchy="false">)</mo><mo>=</mo><mi>log</mi><mo>⁡</mo><mo stretchy="false">(</mo><msub><mi>Z</mi><mn>1</mn></msub><mo stretchy="false">)</mo><mo>−</mo><mi>log</mi><mo>⁡</mo><mo stretchy="false">(</mo><msub><mi>Z</mi><mn>2</mn></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\log(BF) = \log(Z_1) - \log(Z_2)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.13889em;">BF</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">Z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">Z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span> in log space). Typically, if <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>log</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>B</mi><mi>F</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\log(BF)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.13889em;">BF</span><span class="mclose">)</span></span></span></span> is greater than 1, <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>M</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">M_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.109em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> is favoured, otherwise  <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>M</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">M_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.109em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> and  <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi><mn>2</mn></mrow><annotation encoding="application/x-tex">M2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="mord">2</span></span></span></span> are hardly distinguishable or  <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>M</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">M_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.109em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> is favoured. How much  <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>M</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">M_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.109em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> is favoured over  <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>M</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">M_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.109em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> can be found in the following table <a class="citation" href="#kass1995bayes">(Kass &amp; Raftery, 1995)</a>:</p>

<figure>
	<a name="fig:bfs"></a>
	<img style="width:80.0%;" src="figures/BFs.png" alt="" />
	<figcaption>Figure 1: Bayes' factor support in favour of \(M_1\) over \(M_2\).</figcaption>
</figure>

<p>Note that BFs are sometimes multiplied by a factor of 2, so beware of which definition was used when comparing BFs from different publications.</p>

<p><strong>Nested sampling</strong> (NS) is an algorithm that works as follows:</p>

<ul>
  <li>Randomly sample <code class="language-plaintext highlighter-rouge">N</code> points (also called particles) from the prior distribution</li>
  <li>While (marginal) likelihood estimates have not converged
    <ul>
      <li>Pick the point with the lowest likelihood <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>L</mi><mrow><mi>m</mi><mi>i</mi><mi>n</mi></mrow></msub></mrow><annotation encoding="application/x-tex">L_{min}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">min</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> and save it to the log file</li>
      <li>Replace the point with a new one sampled from the prior via an MCMC chain of <code class="language-plaintext highlighter-rouge">subChainLength</code> steps, <strong>under the condition that the new likelihood is at least <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>L</mi><mrow><mi>m</mi><mi>i</mi><mi>n</mi></mrow></msub></mrow><annotation encoding="application/x-tex">L_{min}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">min</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></strong></li>
    </ul>
  </li>
</ul>

<p>The main parameters of the NS algorithm are the number of particles (<code class="language-plaintext highlighter-rouge">N</code>) and the length of the MCMC chain to sample a replacement particle (<code class="language-plaintext highlighter-rouge">subChainLength</code>). To determine <code class="language-plaintext highlighter-rouge">N</code>, we first start the NS analysis with <code class="language-plaintext highlighter-rouge">N=1</code>. Based on the results of that analysis, we can determine a target standard deviation for marginal likelihood estimates and calculate the required <code class="language-plaintext highlighter-rouge">N</code> value using the estimated information measure <code class="language-plaintext highlighter-rouge">H</code> and a given formula (more details will follow later in the tutorial).</p>

<p>The <code class="language-plaintext highlighter-rouge">subChainLength</code> determines how independent the replacement point is from the <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>L</mi><mrow><mi>m</mi><mi>i</mi><mi>n</mi></mrow></msub></mrow><annotation encoding="application/x-tex">L_{min}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">min</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> point that was saved and is a parameter that needs to be determined by trial and error (see <a href="#nested-sampling-faq">FAQ</a> for details).</p>

<hr />

<h1 id="programs-used-in-this-tutorial">Programs used in this tutorial</h1>

<h3 id="beast2---bayesian-evolutionary-analysis-sampling-trees-2">BEAST2 - Bayesian Evolutionary Analysis Sampling Trees 2</h3>

<p>BEAST2 is a free software package for Bayesian evolutionary analysis of molecular sequences using MCMC and strictly oriented toward inference using rooted, time-measured phylogenetic trees <a class="citation" href="#Bouckaert2014">(Bouckaert et al., 2014)</a>, <a class="citation" href="#bouckaert2018beast">(Bouckaert et al., 2018)</a>. This tutorial uses the BEAST2 version 2.7.x.</p>

<h3 id="beauti2---bayesian-evolutionary-analysis-utility">BEAUti2 - Bayesian Evolutionary Analysis Utility</h3>

<p>BEAUti2 is a graphical user interface tool for generating BEAST2 XML configuration files.</p>

<p>Both BEAST2 and BEAUti2 are Java programs, which means that the exact same code runs on all platforms. For us it simply means that the interface will be the same on all platforms. The screenshots used in this tutorial are taken on a Mac OS X computer; however, both programs will have the same layout and functionality on both Windows and Linux. BEAUti2 is provided as a part of the BEAST2 package so you do not need to install it separately.</p>

<h3 id="tracer">Tracer</h3>

<p><a href="http://tree.bio.ed.ac.uk/software/tracer">Tracer</a> is used to summarise the posterior estimates of the various parameters sampled by the Markov Chain. This program can be used for visual inspection and to assess convergence. It helps to quickly view median estimates and 95% highest posterior density intervals of the parameters, and calculates the effective sample sizes (ESS) of parameters. It can also be used to investigate potential parameter correlations. We will be using Tracer v1.7.2.</p>

<hr />

<h1 id="practical-selecting-a-clock-model">Practical: Selecting a clock model</h1>

<p>In this tutorial, we will analyse a dataset of hepatitis B virus (HBV) sequences sampled through time and concentrate on selecting a clock model. 
We will select between two popular clock models, the strict clock and the uncorrelated relaxed clock with log-normal-distributed rates (UCLN).</p>

<h2 id="setting-up-the-strict-clock-analysis">Setting up the strict clock analysis</h2>

<p>First thing to do is set up the two analyses in BEAUti, and run them in order to make sure there are differences in the analyses. The alignment can be downloaded <a href="https://raw.githubusercontent.com/rbouckaert/NS-tutorial/master/data/HBV.nex">here</a>. We will set up a model with tip dates, the HKY substitution model, the coalescent tree prior with constant population size, and a fixed clock rate.</p>

<blockquote>
  <p><strong>In BEAUti:</strong></p>

  <ul>
    <li>Start a new analysis using the <code class="language-plaintext highlighter-rouge">File &gt; Template &gt; Standard</code> template.</li>
    <li>Import <a href="https://raw.githubusercontent.com/rbouckaert/NS-tutorial/master/data/HBV.nex">HBV.nex</a> using <code class="language-plaintext highlighter-rouge">File &gt; Import alignment</code>.</li>
    <li>In the <code class="language-plaintext highlighter-rouge">Tip Dates</code> panel, select <code class="language-plaintext highlighter-rouge">Use tip dates</code>, click <code class="language-plaintext highlighter-rouge">Auto-configure</code>, select <code class="language-plaintext highlighter-rouge">split on character</code> and take group 2 (see <a href="#fig:auto-config">Fig 2</a>).</li>
    <li>In the <code class="language-plaintext highlighter-rouge">Site Model</code> panel, select <code class="language-plaintext highlighter-rouge">HKY</code> as the substitution model (<code class="language-plaintext highlighter-rouge">Subst Model</code>) and leave the rest as is.</li>
    <li>In the <code class="language-plaintext highlighter-rouge">Clock Model</code> panel, set the <code class="language-plaintext highlighter-rouge">Mean clock rate</code> to <code class="language-plaintext highlighter-rouge">2E-5</code>. Usually we would want to estimate the clock rate, but to speed up the analysis for the tutorial we will fix the clock rate to <code class="language-plaintext highlighter-rouge">2E-5</code> as follows:
      <ul>
        <li>Uncheck <code class="language-plaintext highlighter-rouge">Mode &gt; Automatic set clock rate</code>. Now the <code class="language-plaintext highlighter-rouge">estimate</code> entry should not be grayed out anymore (see <a href="#fig:uncheck-auto-set">Fig 3</a>).</li>
        <li>Uncheck the <code class="language-plaintext highlighter-rouge">estimate</code> box next to the clock rate entry.</li>
      </ul>
    </li>
    <li>In the <code class="language-plaintext highlighter-rouge">Priors</code> panel, select <code class="language-plaintext highlighter-rouge">Coalescent Constant Population</code> as the tree prior. Next, change the prior on the population size parameter <code class="language-plaintext highlighter-rouge">popSize</code> to a <code class="language-plaintext highlighter-rouge">Gamma</code> distribution with <code class="language-plaintext highlighter-rouge">alpha = 0.01</code> and <code class="language-plaintext highlighter-rouge">beta = 100</code> (<a href="#fig:priors">Fig 4</a>).</li>
    <li>In the <code class="language-plaintext highlighter-rouge">MCMC</code> panel, change the <code class="language-plaintext highlighter-rouge">Chain Length</code> to 1 million (<code class="language-plaintext highlighter-rouge">1E6</code>). You can also rename the output files for <code class="language-plaintext highlighter-rouge">tracelog</code> and <code class="language-plaintext highlighter-rouge">treelog</code> to include “Strict” to distinguish them from the relaxed clock analysis.</li>
    <li>Save the file as <code class="language-plaintext highlighter-rouge">HBVStrict.xml</code>, and <strong>do not close BEAUti just yet!</strong></li>
    <li>Run the analysis with BEAST.</li>
  </ul>
</blockquote>

<blockquote>

  <p><strong>Note: Do you have a clock rate prior in the <code class="language-plaintext highlighter-rouge">Priors</code> panel?</strong> If so, the clock rate is being estimated, and you should revisit the <code class="language-plaintext highlighter-rouge">Clock Model</code> panel where the clock is set up!</p>

</blockquote>

<figure>
	<a name="fig:auto-config"></a>
	<img style="width:80.0%;" src="figures/BEAUti-configure-tip-dates.png" alt="" />
	<figcaption>Figure 2: Configuring tip dates in BEAUti.</figcaption>
</figure>
<p><br /></p>

<figure>
	<a name="fig:uncheck-auto-set"></a>
	<img style="width:80.0%;" src="figures/BEAUti-uncheck-auto-set.png" alt="" />
	<figcaption>Figure 3: Unchecking "Automatic set clock rate" in BEAUti.</figcaption>
</figure>
<p><br /></p>

<figure>
	<a name="fig:priors"></a>
	<img style="width:80.0%;" src="figures/BEAUti-priors.png" alt="" />
	<figcaption>Figure 4: Priors panel for strict clock analysis in BEAUti.</figcaption>
</figure>
<p><br /></p>

<h2 id="setting-up-the-relaxed-clock-analysis">Setting up the relaxed clock analysis</h2>

<blockquote>
  <p><strong>While you are waiting for the strict clock analysis to finish, you can set up the relaxed clock analysis. This is now straightforward if BEAUti is still open (if BEAUti was closed, open BEAUti and load the file <code class="language-plaintext highlighter-rouge">HBVStrict.xml</code> by <code class="language-plaintext highlighter-rouge">File &gt; Load</code>):</strong></p>

  <ul>
    <li>In the <code class="language-plaintext highlighter-rouge">Clock Model</code> panel, change <code class="language-plaintext highlighter-rouge">Strict clock</code> to <code class="language-plaintext highlighter-rouge">Relaxed Clock Log Normal</code>. Next, set the <code class="language-plaintext highlighter-rouge">Mean clock rate</code> to <code class="language-plaintext highlighter-rouge">2E-5</code>, and uncheck the <code class="language-plaintext highlighter-rouge">estimate</code> box.</li>
    <li>In the <code class="language-plaintext highlighter-rouge">MCMC</code> panel, replace <code class="language-plaintext highlighter-rouge">Strict</code> in the file names for <code class="language-plaintext highlighter-rouge">tracelog</code> and <code class="language-plaintext highlighter-rouge">treelog</code> to <code class="language-plaintext highlighter-rouge">UCLN</code>.</li>
    <li>Save the file as <code class="language-plaintext highlighter-rouge">HBVUCLN.xml</code>. <strong>Note: Do not use <code class="language-plaintext highlighter-rouge">File &gt; Save</code>; instead, use <code class="language-plaintext highlighter-rouge">File &gt; Save as</code>, otherwise the strict clock XML file will be overwritten</strong>.</li>
    <li>Run the analysis in BEAST.</li>
  </ul>
</blockquote>

<p>Once both analyses have completed, open the log files in Tracer and compare parameter estimates to see whether the two analyses differ substantially. You may also compare the trees in DensiTree.</p>

<blockquote>
  <ul>
    <li>Are there any parameters that are very different?</li>
    <li>Do tree heights differ substantially?</li>
    <li>Which analysis is preferable and why? 
<!-- depends on the question you want to answer: if tree height is of interest, strict clock is preferred, since it reduces the uncertainty. If kappa is of interest, things are not that different --></li>
  </ul>
</blockquote>

<p>If there are no substantial differences between the analyses for the question you are interested in, you do not have to commit to one model or another, and you can claim that the results are robust under different models.</p>

<p>However, if there are significant differences, you may want to perform a formal test to see which model is preferred over other models (in other words, which model is a better fit to the given data). In a Bayesian context, in practice this comes down to estimating <strong>marginal likelihoods</strong>, and calculating <strong>Bayes’ factors</strong>: the ratios of marginal likelihoods. Nested sampling <a class="citation" href="#russel2018model">(Russel et al., 2018)</a> is one way to estimate marginal likelihoods.</p>

<h2 id="installing-the-ns-package">Installing the NS package</h2>

<p>To use nested sampling, we first have to install the NS (version 1.2.2) package:</p>

<blockquote>
  <p><strong>In BEAUti:</strong></p>

  <ul>
    <li>Open the Package Manager by <code class="language-plaintext highlighter-rouge">File &gt; Manage Packages</code>.</li>
    <li>Select NS and click <code class="language-plaintext highlighter-rouge">Install/Upgrade</code> (<a href="#fig:install">Fig 5</a>).</li>
    <li><strong><em>Restart BEAUti</em></strong> to load the NS package.</li>
  </ul>
</blockquote>

<figure>
	<a id="fig:install"></a>
	<img style="width:80.0%;" src="figures/install_NS.png" alt="" />
	<figcaption>Figure 5: Installing NS in the Package Manager window in BEAUti.</figcaption>
</figure>
<p><br /></p>

<h2 id="setting-up-the-nested-sampling-analyses">Setting up the nested sampling analyses</h2>

<p>You can convert an MCMC analysis to an NS analysis using the <code class="language-plaintext highlighter-rouge">MCMC2NS</code> tool that comes with the NS package.</p>

<blockquote>
  <p><strong>In BEAUti:</strong></p>

  <ul>
    <li>Open the Package Application Launcher via the <code class="language-plaintext highlighter-rouge">File &gt; Launch Apps</code> menu.</li>
    <li>In the dialog that pops up, select the <code class="language-plaintext highlighter-rouge">MCMC to NS converter (NS)</code> app and click <code class="language-plaintext highlighter-rouge">Launch</code>.</li>
    <li>Select the XML file for the strict clock analysis (<code class="language-plaintext highlighter-rouge">HBVStrict.xml</code>), set the output file as <code class="language-plaintext highlighter-rouge">HBVStrict-NS.xml</code> in the same directory.</li>
    <li>Change settings as shown in the <a href="#fig:MCMC2NS">Figure 6</a> below.</li>
    <li>Click <code class="language-plaintext highlighter-rouge">OK</code>, and <code class="language-plaintext highlighter-rouge">HBVStrict-NS.xml</code> should be created.</li>
    <li>Repeat the steps above for the relaxed clock analysis (<code class="language-plaintext highlighter-rouge">HBVUCLN.xml</code>).</li>
  </ul>
</blockquote>

<figure>
	<a name="fig:MCMC2NS"></a>
	<img style="width:80.0%;" src="figures/MCMC2NS.png" alt="" />
	<figcaption>Figure 6: Converting an MCMC analysis to an NS analysis using the MCMC to NS converter</figcaption>
</figure>
<p><br /></p>

<p>Alternatively, you can do the MCMC-to-NS conversion in a text editor as follows:</p>

<blockquote>
  <ul>
    <li>Make a copy of the file <code class="language-plaintext highlighter-rouge">HBVStrict.xml</code>/<code class="language-plaintext highlighter-rouge">HBVUCLN.xml</code> as <code class="language-plaintext highlighter-rouge">HBVStrict-NS.xml</code>/<code class="language-plaintext highlighter-rouge">HBVUCLN-NS.xml</code>.</li>
    <li>Start a text editor and in both copied <code class="language-plaintext highlighter-rouge">*NS.xml</code> files, change</li>
  </ul>

  <div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;run</span> <span class="na">id=</span><span class="s">"mcmc"</span> <span class="na">spec=</span><span class="s">"MCMC"</span> <span class="na">chainLength=</span><span class="s">"1000000"</span><span class="nt">&gt;</span>
</code></pre></div>  </div>
  <p>to</p>
  <div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;run</span> <span class="na">id=</span><span class="s">"mcmc"</span> <span class="na">spec=</span><span class="s">"nestedsampling.gss.NS"</span> <span class="na">chainLength=</span><span class="s">"1000000"</span> <span class="na">particleCount=</span><span class="s">"1"</span> <span class="na">subChainLength=</span><span class="s">"5000"</span><span class="nt">&gt;</span>
</code></pre></div>  </div>

  <ul>
    <li>Here the <code class="language-plaintext highlighter-rouge">particleCount</code> represents the number of active points (<code class="language-plaintext highlighter-rouge">N</code>) used in nested sampling: the more points used, the more accurate the marginal likelihood estimates, but the longer the analysis takes.</li>
    <li>The <code class="language-plaintext highlighter-rouge">subChainLength</code> is the number of MCMC steps taken to get a new point that is independent (enough) from the point that was saved. Longer lengths mean longer runs, but also more independent samples. In practice, running with different <code class="language-plaintext highlighter-rouge">subChainLength</code> is necessary to find out which length is most suitable (see <a href="#nested-sampling-faq">FAQ</a>).</li>
    <li>Change the file names for the trace and tree log to include <code class="language-plaintext highlighter-rouge">NS</code> (searching for <code class="language-plaintext highlighter-rouge">fileName=</code> will get you there fastest).</li>
    <li>Save the files, and run with BEAST.</li>
  </ul>
</blockquote>

<p>Once the NS analyses have completed, you should see something like this at the end of the BEAST output for the strict clock NS analysis:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Total calculation time: 14.983 seconds
End likelihood: -198.17149973585296
Producing posterior samples

Marginal likelihood: -12428.65341414792 sqrt(H/N)=(10.596753616593245)=?=SD=(10.802109255318992) Information: 112.29118721078201
Max ESS: 17.082043893737673


Processing 228 trees from file.
Log file written to HBVStrict-HBV-NS.posterior.trees
Done!

Marginal likelihood: -12428.505410641856 sqrt(H/N)=(10.58988064783551)=?=SD=(10.328583134047442) Information: 112.14557213540105
Max ESS: 17.443137102014155


Log file written to HBVStrict-NS.posterior.log
Done!
</code></pre></div></div>

<p>and for the relaxed clock NS analysis:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Total calculation time: 17.254 seconds
End likelihood: -198.22029538745582
Producing posterior samples

Marginal likelihood: -12413.866266847353 sqrt(H/N)=(10.966419757539098)=?=SD=(11.100842819562212) Information: 120.2623622985439
Max ESS: 13.251755407507508


Processing 246 trees from file.
Log file written to HBVUCLN-HBV-NS.posterior.trees
Done!

Marginal likelihood: -12413.74471470421 sqrt(H/N)=(10.959292419373286)=?=SD=(11.010465189987908) Information: 120.10609033333276
Max ESS: 13.62674380195755


Log file written to HBVUCLN-NS.posterior.log
Done!
</code></pre></div></div>

<p>Nested sampling produces estimates of marginal likelihoods (ML) as well as their standard deviations (SDs). At first sight, the relaxed clock has a (log) ML estimate of about -12414, while the strict clock is much worse at about -12429. However, the standard deviation of both analyses is about 11, making these estimates indistinguishable. Since this is a stochastic process, the exact numbers for your run will differ, but should not be that far apart (typically less than 2 SDs or about 22 log points in 95% of the time).</p>

<p>To get more accurate ML estimates, the number of particles can be increased. In nested sampling, the SD is approximated by  <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msqrt><mfrac><mi>H</mi><mi>N</mi></mfrac></msqrt></mrow><annotation encoding="application/x-tex">\sqrt{ \frac{H}{N} }</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.84em;vertical-align:-0.5913em;"></span><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.2487em;"><span class="svg-align" style="top:-3.8em;"><span class="pstrut" style="height:3.8em;"></span><span class="mord" style="padding-left:1em;"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8723em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">N</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.08125em;">H</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span><span style="top:-3.2087em;"><span class="pstrut" style="height:3.8em;"></span><span class="hide-tail" style="min-width:1.02em;height:1.88em;"><svg xmlns="http://www.w3.org/2000/svg" width="400em" height="1.88em" viewBox="0 0 400000 1944" preserveAspectRatio="xMinYMin slice"><path d="M983 90 l0 -0 c4,-6.7,10,-10,18,-10 H400000v40 H1013.1s-83.4,268,-264.1,840c-180.7,572,-277,876.3,-289,913c-4.7,4.7,-12.7,7,-24,7 s-12,0,-12,0c-1.3,-3.3,-3.7,-11.7,-7,-25c-35.3,-125.3,-106.7,-373.3,-214,-744 c-10,12,-21,25,-33,39s-32,39,-32,39c-6,-5.3,-15,-14,-27,-26s25,-30,25,-30 c26.7,-32.7,52,-63,76,-91s52,-60,52,-60s208,722,208,722 c56,-175.3,126.3,-397.3,211,-666c84.7,-268.7,153.8,-488.2,207.5,-658.5 c53.7,-170.3,84.5,-266.8,92.5,-289.5z M1001 80h400000v40h-400000z"></path></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.5913em;"><span></span></span></span></span></span></span></span></span>, where <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi></mrow><annotation encoding="application/x-tex">N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span></span></span></span> is the number of particles and  <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>H</mi></mrow><annotation encoding="application/x-tex">H</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.08125em;">H</span></span></span></span> the measure of information. The latter is conveniently estimated and displayed in the NS analysis output (see above).</p>

<p>We can conveniently calculate the desired number of particles  <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi></mrow><annotation encoding="application/x-tex">N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span></span></span></span> using the equation above. To aim for an SD of say 2, we need to run the NS analysis again with <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi></mrow><annotation encoding="application/x-tex">N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span></span></span></span> particles such that  <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msqrt><mfrac><mi>H</mi><mi>N</mi></mfrac></msqrt><mo>=</mo><msqrt><mfrac><mn>120</mn><mi>N</mi></mfrac></msqrt><mo>=</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">\sqrt{ \frac{H}{N} } = \sqrt{ \frac{120}{N} } = 2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.84em;vertical-align:-0.5913em;"></span><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.2487em;"><span class="svg-align" style="top:-3.8em;"><span class="pstrut" style="height:3.8em;"></span><span class="mord" style="padding-left:1em;"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8723em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">N</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.08125em;">H</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span><span style="top:-3.2087em;"><span class="pstrut" style="height:3.8em;"></span><span class="hide-tail" style="min-width:1.02em;height:1.88em;"><svg xmlns="http://www.w3.org/2000/svg" width="400em" height="1.88em" viewBox="0 0 400000 1944" preserveAspectRatio="xMinYMin slice"><path d="M983 90 l0 -0 c4,-6.7,10,-10,18,-10 H400000v40 H1013.1s-83.4,268,-264.1,840c-180.7,572,-277,876.3,-289,913c-4.7,4.7,-12.7,7,-24,7 s-12,0,-12,0c-1.3,-3.3,-3.7,-11.7,-7,-25c-35.3,-125.3,-106.7,-373.3,-214,-744 c-10,12,-21,25,-33,39s-32,39,-32,39c-6,-5.3,-15,-14,-27,-26s25,-30,25,-30 c26.7,-32.7,52,-63,76,-91s52,-60,52,-60s208,722,208,722 c56,-175.3,126.3,-397.3,211,-666c84.7,-268.7,153.8,-488.2,207.5,-658.5 c53.7,-170.3,84.5,-266.8,92.5,-289.5z M1001 80h400000v40h-400000z"></path></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.5913em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.84em;vertical-align:-0.6049em;"></span><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.2351em;"><span class="svg-align" style="top:-3.8em;"><span class="pstrut" style="height:3.8em;"></span><span class="mord" style="padding-left:1em;"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8451em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">N</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">120</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span><span style="top:-3.1951em;"><span class="pstrut" style="height:3.8em;"></span><span class="hide-tail" style="min-width:1.02em;height:1.88em;"><svg xmlns="http://www.w3.org/2000/svg" width="400em" height="1.88em" viewBox="0 0 400000 1944" preserveAspectRatio="xMinYMin slice"><path d="M983 90 l0 -0 c4,-6.7,10,-10,18,-10 H400000v40 H1013.1s-83.4,268,-264.1,840c-180.7,572,-277,876.3,-289,913c-4.7,4.7,-12.7,7,-24,7 s-12,0,-12,0c-1.3,-3.3,-3.7,-11.7,-7,-25c-35.3,-125.3,-106.7,-373.3,-214,-744 c-10,12,-21,25,-33,39s-32,39,-32,39c-6,-5.3,-15,-14,-27,-26s25,-30,25,-30 c26.7,-32.7,52,-63,76,-91s52,-60,52,-60s208,722,208,722 c56,-175.3,126.3,-397.3,211,-666c84.7,-268.7,153.8,-488.2,207.5,-658.5 c53.7,-170.3,84.5,-266.8,92.5,-289.5z M1001 80h400000v40h-400000z"></path></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.6049em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">2</span></span></span></span>, hence  <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi><mo>=</mo><mfrac><mn>120</mn><msup><mn>2</mn><mn>2</mn></msup></mfrac><mo>=</mo><mn>30</mn></mrow><annotation encoding="application/x-tex">N = \frac{120}{2^2} = 30</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.1901em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8451em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7463em;"><span style="top:-2.786em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">120</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">30</span></span></span></span> should be enough. (Note that I used  <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>H</mi><mo>=</mo><mn>120</mn></mrow><annotation encoding="application/x-tex">H = 120</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">120</span></span></span></span> as estimated by the relaxed clock NS analysis instead of  <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>H</mi><mo>=</mo><mn>112</mn></mrow><annotation encoding="application/x-tex">H = 112</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">112</span></span></span></span> by the strict clock to have some “safety margin”.)</p>

<p>The computation time of nested sampling is linear with the number of particles, so it will take about 30 times longer to run if we change the <code class="language-plaintext highlighter-rouge">particleCount</code> from 1 to 30 in the XML:</p>

<blockquote>
  <ul>
    <li>Make a copy of the file <code class="language-plaintext highlighter-rouge">HBVStrict-NS.xml</code>/<code class="language-plaintext highlighter-rouge">HBVUCLN-NS.xml</code> as <code class="language-plaintext highlighter-rouge">HBVStric-NS30.xml</code>/<code class="language-plaintext highlighter-rouge">HBVUCLN-NS30.xml</code>.</li>
    <li>Start a text editor and in both copied <code class="language-plaintext highlighter-rouge">*NS30.xml</code> files, change</li>
  </ul>

  <div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;run</span> <span class="na">id=</span><span class="s">"mcmc"</span> <span class="na">spec=</span><span class="s">"nestedsampling.gss.NS"</span> <span class="na">chainLength=</span><span class="s">"1000000"</span> <span class="na">particleCount=</span><span class="s">"1"</span> <span class="na">subChainLength=</span><span class="s">"5000"</span><span class="nt">&gt;</span>
</code></pre></div>  </div>
  <p>to</p>
  <div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;run</span> <span class="na">id=</span><span class="s">"mcmc"</span> <span class="na">spec=</span><span class="s">"nestedsampling.gss.NS"</span> <span class="na">chainLength=</span><span class="s">"1000000"</span> <span class="na">particleCount=</span><span class="s">"30"</span> <span class="na">subChainLength=</span><span class="s">"5000"</span><span class="nt">&gt;</span>
</code></pre></div>  </div>
</blockquote>

<p>To save time, this tutorial provides you pre-cooked NS runs using 30 particles: HBVStrict-NS30.log and HBVUCLN-NS30.log.</p>

<h2 id="analyzing-the-nested-sampling-results">Analyzing the nested sampling results</h2>

<p>We will now download the pre-cooked log files <a href="https://raw.githubusercontent.com/sgtRoberty/NS-tutorial/refs/heads/main/precooked_runs/HBVStrict-NS30.log">HBVStrict-NS30.log</a> and <a href="https://raw.githubusercontent.com/rbouckaert/NS-tutorial/master/precooked_runs/HBVUCLN-NS32.log">HBVUCLN-NS30.log</a> and analyze them using the <code class="language-plaintext highlighter-rouge">NSLogAnalyser</code> tool that comes with the NS package:</p>

<blockquote>
  <p><strong>In BEAUti:</strong></p>

  <ul>
    <li>Open the Package Application Launcher via <code class="language-plaintext highlighter-rouge">File &gt; Launch Apps</code>.</li>
    <li>In the dialog,  select the <code class="language-plaintext highlighter-rouge">Nested Sampling Log Analyser (NS)</code> app and click <code class="language-plaintext highlighter-rouge">Launch</code>.</li>
    <li>Select the log file for the strict clock analysis (<code class="language-plaintext highlighter-rouge">HBVStrict-NS30.log</code>), set the output file as <code class="language-plaintext highlighter-rouge">HBVStrict-NS30.out</code> in the same directory.</li>
    <li>Change <code class="language-plaintext highlighter-rouge">N</code> (number of particles) to <code class="language-plaintext highlighter-rouge">30</code> as shown in the <a href="#fig:nsloganalyser">Figure 7</a> below.</li>
    <li>Click <code class="language-plaintext highlighter-rouge">OK</code>, and after some time the output should be directly printed out in the pop-up window.</li>
    <li>Repeat the steps above for the relaxed clock analysis (<code class="language-plaintext highlighter-rouge">HBVUCLN-NS30.log</code>).</li>
  </ul>
</blockquote>

<figure>
	<a name="fig:nsloganalyser"></a>
	<img style="width:80.0%;" src="figures/loganalyser.png" alt="" />
	<figcaption>Figure 7: Analyzing the log file of a 30-particle NS analysis using the Nested Sampling Log Analyser</figcaption>
</figure>
<p><br /></p>

<p>The output for the strict clock NS analysis should look like this:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Loading HBVStrict-NS30.log, burnin 0%, skipping 0 log lines

|---------|---------|---------|---------|---------|---------|---------|---------|
*********************************************************************************

Marginal likelihood: -12426.424659219112 sqrt(H/N)=(1.9487197469883364)=?=SD=(1.8689265005123525) Information: 113.92525956906857
Max ESS: 415.691078202295

Calculating statistics

|---------|---------|---------|---------|---------|---------|---------|---------|
********************************************************************************

#Particles = 30
item               mean     stddev   
posterior          -12509.4 3.380924
likelihood         -12312.4 3.312481
prior              -196.985 1.44903 
treeLikelihood     -12312.4 3.312481
Tree.height        3470.464 130.0832
Tree.treeLength    20696.58 559.9497
kappa              2.698771 0.1626  
freqParameter.1    0.240524 0.006909
freqParameter.2    0.270687 0.00763 
freqParameter.3    0.219939 0.006023
freqParameter.4    0.268849 0.007123
popSize            2325.738 298.5557
CoalescentConstant -163.330 2.961035
Done!
</code></pre></div></div>

<p>This gives us an ML estimate of -12426.4 with an SD of 1.95 for the strict clock model, slightly better than the SD of 2 we aimed for.</p>

<!-- Furthermore, there are posterior estimates of all the entries in the trace log. Nested sampling does not only estimate MLs and SDs, but can also provide a sample from the posterior, which can be useful for cases where MCMC has trouble with convergence. But let's not digress too much and get back to model selection. -->

<p>For the relaxed clock NS analysis, we get:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Marginal likelihood: -12417.941209427103 sqrt(H/N)=(2.037101812671995)=?=SD=(2.0736988078248095) Information: 124.49351385574582
</code></pre></div></div>
<p>This gives us an ML of -12417.9 with an SD of 2.04 for the uncorrelated log-normal relaxed clock model.</p>

<p>Therefore, the <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>log</mi><mo>⁡</mo><mrow><mi>B</mi><mi>F</mi></mrow></mrow><annotation encoding="application/x-tex">\log{BF}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">BF</span></span></span></span></span> of the relaxed clock <em>versus</em> the strict clock is  <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>−</mo><mn>12417.9</mn><mo>−</mo><mo stretchy="false">(</mo><mo>−</mo><mn>12426.4</mn><mo stretchy="false">)</mo><mo>=</mo><mn>8.5</mn></mrow><annotation encoding="application/x-tex">-12417.9 - (-12426.4) = 8.5</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">−</span><span class="mord">12417.9</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">−</span><span class="mord">12426.4</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">8.5</span></span></span></span>, which is more than twice the sum of the SDs (<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1.95</mn><mo>+</mo><mn>2.04</mn><mo>=</mo><mn>3.99</mn></mrow><annotation encoding="application/x-tex">1.95 + 2.04 = 3.99</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">1.95</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">2.04</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">3.99</span></span></span></span>), which can be considered as reliable evidence in favour of the log-normal relaxed clock model over the strict clock. Note that judging from <a href="#fig:bfs">Figure 1</a>, this amounts to overwhelming support for the relaxed clock.</p>

<!--
## Setting up the geographic model with strict and relaxed clock

* Install the GEO_SPHERE package.
* Go to the data partitions tab, and click the '+' button at the bottom of the screen.
A dialog pops up where you can select what you want to add. Choose `Add Spherical Geography` and click `OK`.
* A new window pops up where you can choose the tree where you want to add geography.
Also, you can change the trait name to `geo`;
* When you click OK, a dialog is shown where you can enter latitude and longitude for each taxon. In this tutorial, this information is encoded in the taxon name, so we can guess it from the name. 
	* Click `Guess latitude`, and a dialog is shown. Choose `split on character` and take group 3 for the latitude. When you click OK, the latitude field of the table is populated.
	* Click `Guess longitude`, and again a dialog is shown. Choose `split on character` and take group 4 for the longitude.
	When you click OK, the table is completely populated. 
* Now, the longitudes and latitudes are properly populated. Click close, and a second data partition is created.
* The clock model now looks like this:
* For the geography, we select a strict clock for the first analysis (save as `HBVgeoStrict.xml`) and a relaxed clock with log-normal distribution for the second analysis) save as `HBVgeoUCLN.xml`). 
* As before, copy the files to a name including NS and in a text editor change
```xml
<run id="mcmc" spec="MCMC" chainLength="1000000">
```
to
```xml
<run id="mcmc" spec="beast.gss.NS" chainLength="20000" particleCount="1" subChainLength="5000">
```
* Save both files, and run with BEAST.
-->

<h1 id="nested-sampling-faq">Nested sampling FAQ</h1>
<p><a name="nested-sampling-faq">  </a></p>

<h2 id="the-analysis-prints-out-multiple-ml-estimates-with-their-sds-which-one-should-i-choose">The analysis prints out multiple ML estimates with their SDs. Which one should I choose?</h2>

<p>The difference between the estimates is due to the ways they are estimated from the nested sampling run. Since these are estimates that require random sampling, they differ from one estimate to another. When the standard deviation is small, the estimates will be very close, but when the standard deviations is quite large, the ML estimates can substantially differ. Regardless, any of the reported estimates are valid estimates, but make sure to report them with their standard deviation.</p>

<h2 id="how-do-i-know-the-sub-chain-length-is-large-enough">How do I know the sub-chain length is large enough?</h2>

<p>NS works in theory if and only if the points generated at each iteration are independent. If you already did an MCMC run and know the effective sample size (ESS) for each parameter, to be sure every parameter in every sample is independent you can take the length of the MCMC run divided by the smallest ESS as the sub-chain length. This tends to result in quite large sub-chain lengths.</p>

<p>In practice, we can get away much shorter sub-chain lengths, which you can verify by running multiple NS analyses with increasing sub-chain lengths. If the ML and SD estimates do not substantially differ, shorter sub-chain length will be sufficient.</p>

<h2 id="how-many-particles-do-i-need">How many particles do I need?</h2>

<p>To start, use only a few particles to get a sense of the information <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>H</mi></mrow><annotation encoding="application/x-tex">H</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.08125em;">H</span></span></span></span>, which is estimated in the NS analysis. If you want to compare two models, the difference between their marginal likelihood estimates, <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Z</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">Z_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">Z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> and <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Z</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">Z_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">Z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>, needs to be at least <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>2</mn><mo>×</mo><msqrt><mrow><msup><mrow><mi>S</mi><msub><mi>D</mi><mn>1</mn></msub></mrow><mn>2</mn></msup><mo>+</mo><msup><mrow><mi>S</mi><msub><mi>D</mi><mn>2</mn></msub></mrow><mn>2</mn></msup></mrow></msqrt></mrow><annotation encoding="application/x-tex">2 \times \sqrt{ {SD_1}^2 + {SD_2}^2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.24em;vertical-align:-0.1863em;"></span><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0537em;"><span class="svg-align" style="top:-3.2em;"><span class="pstrut" style="height:3.2em;"></span><span class="mord" style="padding-left:1em;"><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8873em;"><span style="top:-3.1362em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8873em;"><span style="top:-3.1362em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span><span style="top:-3.0137em;"><span class="pstrut" style="height:3.2em;"></span><span class="hide-tail" style="min-width:1.02em;height:1.28em;"><svg xmlns="http://www.w3.org/2000/svg" width="400em" height="1.28em" viewBox="0 0 400000 1296" preserveAspectRatio="xMinYMin slice"><path d="M263,681c0.7,0,18,39.7,52,119 c34,79.3,68.167,158.7,102.5,238c34.3,79.3,51.8,119.3,52.5,120 c340,-704.7,510.7,-1060.3,512,-1067 l0 -0 c4.7,-7.3,11,-11,19,-11 H40000v40H1012.3 s-271.3,567,-271.3,567c-38.7,80.7,-84,175,-136,283c-52,108,-89.167,185.3,-111.5,232 c-22.3,46.7,-33.8,70.3,-34.5,71c-4.7,4.7,-12.3,7,-23,7s-12,-1,-12,-1 s-109,-253,-109,-253c-72.7,-168,-109.3,-252,-110,-252c-10.7,8,-22,16.7,-34,26 c-22,17.3,-33.3,26,-34,26s-26,-26,-26,-26s76,-59,76,-59s76,-60,76,-60z M1001 80h400000v40h-400000z"></path></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1863em;"><span></span></span></span></span></span></span></span></span> to make sure the difference is not due to randomization.</p>

<p>If the difference is larger, you do not need more particles. If the difference is smaller, you can estimate how much the SD estimates must shrink to get a difference that is sufficiently large. Since <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mi>D</mi><mo>=</mo><msqrt><mfrac><mi>H</mi><mi>N</mi></mfrac></msqrt></mrow><annotation encoding="application/x-tex">SD = \sqrt{ \frac{H}{N} }</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.84em;vertical-align:-0.5913em;"></span><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.2487em;"><span class="svg-align" style="top:-3.8em;"><span class="pstrut" style="height:3.8em;"></span><span class="mord" style="padding-left:1em;"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8723em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">N</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.08125em;">H</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span><span style="top:-3.2087em;"><span class="pstrut" style="height:3.8em;"></span><span class="hide-tail" style="min-width:1.02em;height:1.88em;"><svg xmlns="http://www.w3.org/2000/svg" width="400em" height="1.88em" viewBox="0 0 400000 1944" preserveAspectRatio="xMinYMin slice"><path d="M983 90 l0 -0 c4,-6.7,10,-10,18,-10 H400000v40 H1013.1s-83.4,268,-264.1,840c-180.7,572,-277,876.3,-289,913c-4.7,4.7,-12.7,7,-24,7 s-12,0,-12,0c-1.3,-3.3,-3.7,-11.7,-7,-25c-35.3,-125.3,-106.7,-373.3,-214,-744 c-10,12,-21,25,-33,39s-32,39,-32,39c-6,-5.3,-15,-14,-27,-26s25,-30,25,-30 c26.7,-32.7,52,-63,76,-91s52,-60,52,-60s208,722,208,722 c56,-175.3,126.3,-397.3,211,-666c84.7,-268.7,153.8,-488.2,207.5,-658.5 c53.7,-170.3,84.5,-266.8,92.5,-289.5z M1001 80h400000v40h-400000z"></path></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.5913em;"><span></span></span></span></span></span></span></span></span>, we have <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi><mo>=</mo><mfrac><mi>H</mi><mrow><mi>S</mi><msup><mi>D</mi><mn>2</mn></msup></mrow></mfrac></mrow><annotation encoding="application/x-tex">N = \frac{H}{SD^2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.2173em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8723em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05764em;">S</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7463em;"><span style="top:-2.786em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.08125em;">H</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span>, where <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>H</mi></mrow><annotation encoding="application/x-tex">H</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.08125em;">H</span></span></span></span> comes from the NS analysis with a few particles. Next, you can run the analysis again with the increased number of particles <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi></mrow><annotation encoding="application/x-tex">N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span></span></span></span> and see if the difference becomes large enough.</p>

<p>If the difference between marginal likelihood estimates is less than 2, the hypotheses may not be distinguishable – in terms of Bayes’ factors, the difference is barely worth mentioning.</p>

<h2 id="is-ns-faster-than-path-samplingstepping-stone-psss">Is NS faster than path sampling/stepping stone (PS/SS)?</h2>

<p>This depends on many things, but in general, depends on how accurate the estimates should be. For NS, we get an estimate of the SD, which is not available for PS/SS. If the hypotheses have very large differences in MLs, NS requires very few (maybe just 1) particle, and will be very fast. If differences are smaller, more particles may be required, and the run-time of NS is linear in the number of particles.</p>

<p>The parallel implementation makes it possible to run many particles in parallel, giving a many-particle estimate in the same time as a single particle estimate (PS/SS can be parallelised by steps as well).</p>

<h2 id="the-output-is-written-on-screen-which-i-forgot-to-save-can-i-estimate-them-directly-from-the-log-files">The output is written on screen, which I forgot to save. Can I estimate them directly from the log files?</h2>

<p>The NS package has a <code class="language-plaintext highlighter-rouge">NSLogAnalyser</code> application that you can run via the menu <code class="language-plaintext highlighter-rouge">File &gt; Launch Apps</code> in BEAUti – a window pops up where you select the <code class="language-plaintext highlighter-rouge">NSLogAnalyser</code>, and a dialog shows you various options to fill in. You can also run it from the command line on OS X or Linux using</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>/path/to/beast/bin/applauncher NSLogAnalyser -N 1 -log  xyz.log
</code></pre></div></div>

<p>where the argument after <code class="language-plaintext highlighter-rouge">N</code> is the <code class="language-plaintext highlighter-rouge">particleCount</code> you specified in the XML, and <code class="language-plaintext highlighter-rouge">xyz.log</code> the trace log produced by the NS run.</p>

<h2 id="why-are-some-ns-runs-longer-than-others">Why are some NS runs longer than others?</h2>

<p>Nested sampling stops automatically when the accuracy in the ML estimate cannot be improved upon. Because it is a stochastic process, some analyses get there faster than others, resulting in different run times.</p>

<h2 id="why-are-the-esss-so-low-when-i-open-a-log-file-in-tracer">Why are the ESSs so low when I open a log file in Tracer?</h2>

<p>An NS analysis produces two trace log files: one for the nested sampling run (say <code class="language-plaintext highlighter-rouge">myFile.log</code>) and one with the posterior sample (<code class="language-plaintext highlighter-rouge">myFile.posterior.log</code>).</p>

<p>The ESSs in Tracer of log files with the posterior samples are meaningless, because the log file is ordered using the nested sampling run. If you look at the trace of the Likelihood, it should show a continuous increasing function. It is not quite clear how to estimate ESSs of a nested sampling run yet, though the number of entries in the posterior log is equal to the maximum theoretical ESS, which is almost surely an overestimate.</p>

<hr />

<h1 id="useful-links">Useful Links</h1>

<ul>
  <li><a href="http://www.beast2.org/book.html">Bayesian Evolutionary Analysis with BEAST 2</a> <a class="citation" href="#BEAST2book2014">(Drummond &amp; Bouckaert, 2014)</a></li>
  <li>BEAST 2 website and documentation: <a href="http://www.beast2.org/">http://www.beast2.org/</a></li>
  <li>Nested sampling website and documentation: <a href="https://github.com/BEAST2-Dev/nested-sampling">https://github.com/BEAST2-Dev/nested-sampling</a></li>
  <li>Join the BEAST user discussion: <a href="http://groups.google.com/group/beast-users">http://groups.google.com/group/beast-users</a></li>
</ul>

<h1 id="relevant-references">Relevant References</h1>

<ol class="bibliography"><li><span id="kass1995bayes">Kass, R. E., &amp; Raftery, A. E. (1995). Bayes factors. <i>Journal of the American Statistical Association</i>, <i>90</i>(430), 773–795.</span></li>
<li><span id="Bouckaert2014">Bouckaert, R., Heled, J., Kühnert, D., Vaughan, T., Wu, C.-H., Xie, D., Suchard, M. A., Rambaut, A., &amp; Drummond, A. J. (2014). BEAST 2: a software platform for Bayesian evolutionary analysis. <i>PLoS Computational Biology</i>, <i>10</i>(4), e1003537. https://doi.org/10.1371/journal.pcbi.1003537</span></li>
<li><span id="bouckaert2018beast">Bouckaert, R., Vaughan, T. G., Barido-Sottani, J., Duchene, S., Fourment, M., Gavryushkina, A., Heled, J., Jones, G., Kuhnert, D., De Maio, N., &amp; others. (2018). BEAST 2.5: An Advanced Software Platform for Bayesian Evolutionary Analysis. <i>BioRxiv</i>, 474296.</span></li>
<li><span id="russel2018model">Russel, P. M., Brewer, B. J., Klaere, S., &amp; Bouckaert, R. R. (2018). Model selection and parameter inference in phylogenetics using Nested Sampling. <i>Systematic Biology</i>, <i>68</i>(2), 219–233.</span></li>
<li><span id="BEAST2book2014">Drummond, A. J., &amp; Bouckaert, R. R. (2014). <i>Bayesian evolutionary analysis with BEAST 2</i>. Cambridge University Press.</span></li></ol>


			<hr>
			<h1>Citation</h1>

			
<p>If you found <strong>Taming the BEAST</strong> helpful in designing your research, please cite the following paper:</p>

<p style="margin-left: 40px">
Joëlle Barido-Sottani, Veronika Bošková, Louis du Plessis, Denise Kühnert, Carsten Magnus, Venelin Mitov, Nicola F. Müller, Jūlija Pečerska, David A. Rasmussen, Chi Zhang, Alexei J. Drummond, Tracy A. Heath, Oliver G. Pybus, Timothy G. Vaughan, Tanja Stadler (2018). Taming the BEAST – A community teaching material resource for BEAST 2. <em>Systematic Biology</em>, <em>67(1)</em>, 170–-174. doi: <a target="_blank" href="https://doi.org/10.1093/sysbio/syx060">10.1093/sysbio/syx060</a>
</p> 
		</div>
	</div>			
	<div class="col-md-1"></div>
</div>


	
	</div>

	<div class="footerspacer"></div>

<div class="footer">
  <div class="container">
    <div class="row">
      <div class="col-md-6">
        <ul class="list-group list-group-horizontal">
        <li class="footernav list-group-item"><a class="foot" href="/about/">about</a></li>
        <li class="footernav list-group-item"><a class="foot" href="/contact/">contact</a></li>
        <li class="footernav list-group-item"><a class="foot" href="/license/">license</a></li>
        </ul>
      </div>
    </div>
  </div>
</div>

	
	<!--div id="footer"><span style="display:none">foo</span></div-->
		
</body>
</html>

